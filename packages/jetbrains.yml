- name: JetBrains
  hosts: 127.0.0.1
  connection: local

  vars:
    pycharm_ver: 2020.3
    pycharm_path: /opt
    download_folder: /home/lberrocal/Downloads
    extracted_folder: "{{ download_folder }}/pycharm-{{ pycharm_ver }}"
    pycharm_bin_folder: "{{ pycharm_path }}/pycharm-{{ pycharm_ver }}/bin"

  tasks:
    - name: Check for downloaded folder
      stat:
        path: "{{ extracted_folder }}"
      register: extracted_folder_info
    - name: Download and extract Pycharm
      when: not extracted_folder_info.stat.exists
      unarchive:
        src: https://download.jetbrains.com/python/pycharm-professional-{{ pycharm_ver }}.tar.gz
        dest: "{{ download_folder }}"
        remote_src: yes
        creates: "{{ extracted_folder }}"
    - name: Install Pycharm
      become: yes
      copy:
        src: "{{ extracted_folder }}"
        dest: "{{ pycharm_path }}"
        mode: 0755
        remote_src: yes
    tasks:
    - name: Add {{pycharm_path}}/bin to path
      become: yes
      lineinfile: 
        dest: /home/lberrocal/.bashrc
        state: present
        insertafter: 'EOF'
        line: "export PATH=$PATH:{{ pycharm_bin_folder }}" 
    
    
     
